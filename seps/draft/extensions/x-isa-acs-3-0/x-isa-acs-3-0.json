{
    "$schema": "http://json-schema.org/draft-04/schema#",
    "title": "isa-acs-3-0",
    "description": "This marking extension was created to apply the SD-EDH Cyber Profile to ISA shared documents. This is one of two extensions used to apply the SD-EDH Cyber profile: the ISA Markings Extension and the ISA Markings Assertions Extension.",
    "type": "object",
    "allOf": [{
        "$ref": "#/definitions/marking_definition",
        "properties": {
            "definition_type": {
                "type": "string",
                "description": "The definition_type property identifies the type of Marking Definition.",
                "enum": ["x-isa-acs-3-0"]
            },
            "definition": {
                "$ref": "#/definitions/isa-acs-3-0",
                "description": "The definition property contains the marking object itself."
            }
        },
        "additionalProperties": false
    }],
    "definitions": {
        "marking_definition": {
            "$comment": "included here for easy validation using online jsonschema checkers - e.g. https://json-schema-validator.herokuapp.com/",
            "type": "object",
            "properties": {
                "name" : {
                    "type" : "string",
                    "description": "A name used to identify the Marking Definition."
                },
                "created_by_ref": {
                    "pattern": "^marking-definition--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$",
                    "description": "The created_by_ref property specifies the ID of the identity object that describes the entity that created this Marking Definition."
                },
                "created": {
                    "$ref": "#/definitions/timestamp",
                    "description": "The created property represents the time at which the first version of this Marking Definition object was created."
                },
                "object_marking_refs": {
                    "type": "array",
                    "description": "The object_marking_refs property specifies a list of IDs of marking-definition objects that apply to this Marking Definition.",
                    "items": {
                        "pattern": "^marking-definition--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                    },
                    "minItems": 1
                }
            }
        },
        "timestamp": {
            "$comment": "included here for easy validation using online jsonschema checkers - e.g. https://json-schema-validator.herokuapp.com/",
            "type": "string",
            "pattern": "^[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])T([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(\\.[0-9]+)?Z$"
        },
        "isa-acs-3-0": {
            "type": "object",
            "description": "The isa-acs-3-0 from ACS",
            "properties": {
                "sep_version": {
                    "type": "integer"
                },
                "identifier": {
                    "type": "string",
                    "description": "Single unique identifier associated with the resource."
                },
                "name": {
                    "type": "string",
                    "description": "Some name for the data marking for user convenience."
                },
                "create_date_time": {
                    "$ref": "#/definitions/timestamp",
                    "description": "The date of the ACS creation."
                },
                "responsible_entity_custodian": {
                    "type": "string",
                    "description": "custodian",
                    "$comment": "enum is Appendix A of ACS 3.0 specification"
                },
                "responsible_entity_originator": {
                    "type": "string",
                    "description": "originator",
                    "$comment": "enum is Appendix A of ACS 3.0 specification"
                },
                "authority_reference": {
                    "type": "string",
                    "$comment": "pattern can be made more robust to represent a urn exactly",
                    "pattern": "^(urn:isa:authority:\\w+)$"
                },
                "policy_reference": {
                    "type": "string",
                    "pattern": "^(urn:isa:policy:acs:ns:v3\\.0\\?privdefault=(permit|deny)&amp;sharedefault=(permit|deny)\\s?)+$"
                },
                "original_classification": {
                    "$ref": "#/definitions/original_classification",
                    "description": "Details for generating a classification authority block based on classification by an Original Classification Authority."
                },
                "derivative_classification": {
                    "$ref": "#/definitions/derivative_classification",
                    "description": "Details for generating a classification authority block based on a derived classification."
                },
                "declassification": {
                    "$ref": "#/definitions/declassification",
                    "description": "The declassification instructions associated with an original or derived classification for generating a classification authority block."
                },
                "resource_disposition": {
                    "$ref": "#/definitions/resource_disposition",
                    "description": "Provide a fixed date and time at which an action is to be taken on the associated resource, such as destruction."
                },
                "public_release": {
                    "$ref": "#/definitions/public_release",
                    "description": "The release authority and date for resources that have been through a formal public release determination process."
                },
                "access_privilege": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "$comment": "$ref - #/definitions/access_privilege"
                    },
                    "minItems": 1,
                    "$comment": "not required, but if used, there must be 1 item"
                },
                "further_sharing": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "$comment": "$ref - #/definitions/further_sharing"
                    },
                    "minItems": 1,
                    "$comment": "not required, but if used, there must be 1 item"
                },
                "control_set": {
                    "$ref": "#/definitions/control_set",
                    "description": "Group of data tags that are used to inform automated access control decisions."
                }
            },
            "additionalProperties": false,
            "required": [
                "sep_version",  
                "identifier",
                "create_date_time",
                "responsible_entity_custodian",
                "policy_reference",
                "control_set"
            ]},
        "shareability": {
            "type": "array",
            "items": {
                "type": "string",
                "enum": ["NCC", "EM", "LE", "IC"]
            }
        },
        "entity": {
            "type": "array",
            "items": {
                "type": "string",
                "enum": ["MII", "GOV", "CTR", "SVR", "SVC", "DEV", "NET"]
            }
        },
       "permitted_nationalities": {
            "type": "array",
            "items": {
                "type": "string",
                "$comment": "values from Geopolitical Entities, Names, and Codes (GENC) Standard Edition 1"
            }
        },
       "permitted_organizations": {
           "type": "array",
           "items": {
               "type": "string",
               "$comment": "enum is Appendix A of ACS 3.0 specification"
           }
       },
        "control_set": {
            "type": "object",
            "properties": {
                "classification": {
                    "type": "string",
                    "enum": [ "U", "C", "S", "TS"]
                },
                "sci_controls": {
                    "type": "array",
                    "items": {
                        "type": "string",
                        "$comment": "classified enum"
                    }
                },
                "logical_authority_category": {
                    "type": "array",
                    "items": {
                        "type": "string",
                        "$comment": "values are listed in the NSAâ€™s Master Data Registry"
                    }
                },
                "formal_determination": {
                    "type": "array",
                    "items": {
                        "type": "string",
                        "enum": [
                            "PUBREL",
                            "NF",
                            "AIS",
                            "PII-NECESSARY-TO-UNDERSTAND-THREAT",
                            "NO-PII-PRESENT",
                            "FOUO"
                        ]
                    }
                },
                "caveat": {
                    "type": "array",
                    "items": {
                        "type": "string",
                        "enum": [
                            "FISA",
                            "POSSIBLEPII",
                            "CISAPROPRIETARY"
                        ]
                    }
                },
                "sensitivity": {
                    "type": "array",
                    "items": {
                        "type": "string",
                        "enum": [
                            "NTOC_DHS_ECYBER_SVC_SHARE.NSA.NSA",
                            "PCII",
                            "LES",
                            "INT",
                            "PII",
                            "PR",
                            "TEI"
                        ]
                    }
                },
                "shareability": {
                    "$ref": "#/definitions/shareability"
                },
                "entity": {
                    "$ref": "#/definitions/entity"
                },
                "permitted_nationalities": {
                    "$ref": "#/definitions/permitted_nationalities"
                },
                "permitted_organizations": {
                    "$ref": "#/definitions/permitted_organizations"
                }
            },
            "additionalProperties": false,
            "required": ["classification"]
        },
        "derivative_classification": {
            "type": "object",
            "properties": {
                "classified_by": {"type": "string"},
                "classified_on": {
                    "$ref": "#/definitions/timestamp",
                    "description": "The date an original classification determination was made."
                 },
                 "derived_from": {"type": "string"}
             },
             "additionalProperties": false,
             "required": [
                 "classified_by",
                 "derived_from"
             ]
        },
        "original_classification": {
            "type": "object",
            "properties": {
                "classified_by": {"type": "string"},
                "classified_on": {
                    "$ref": "#/definitions/timestamp",
                    "description": "The date an original classification determination was made."
                },
                "classification_reason": {"type": "string"},
                "compilation_reason": {"type": "string"}
             },
             "additionalProperties": false,
             "required": ["classified_by"]
         },
         "declassification": {
             "type": "object",
             "properties": {
                "declass_exemption": {"type": "string"},
                "declass_period": {"type": "integer"},
                "declass_date": {
                    "$ref": "#/definitions/timestamp",
                    "description": "A date upon which a resource will be automatically declassified if not exempt."
                 },
                 "declass_event": {"type": "string"}
            },
            "additionalProperties": false
          },
         "resource_disposition": {
             "type": "object",
             "properties": {
                 "disposition_date": {
                    "$ref": "#/definitions/timestamp",
                     "description": "The date of the disposition is initiated"
                 },
                 "disposition_process": {"type": "string"}
             },
             "additionalProperties": false
         },
          "public_release": {
            "type": "object",
            "properties": {
                "released_by": {"type": "string"},
                "released_on": {
                    "$ref": "#/definitions/timestamp",
                    "description": "The date of public release."
                }
            },
            "additionalProperties": false
          },
          "privilege_scope": {
              "type": "object",
              "$comment": "how do we represent ALL",
              "properties": {
                  "permitted_nationalities": {
                    "$ref": "#/definitions/permitted_nationalities"
                  },
                  "permitted_organizations": {
                      "$ref": "#/definitions/permitted_organizations"
                  },
                  "shareability": {
                      "$ref": "#/definitions/shareability"
                  },
                  "entity": {
                      "$ref": "#/definitions/entity"
                  }
              },
              "additionalProperties": false
          },
          "access_privilege": {
              "type": "object",
              "properties": {
                  "privilege_action": {
                      "type": "string",
                      "enum": [
                          "DSPLY", "IDSRC", "TENOT", "NETDEF", "LEGAL", "INTEL",
                          "TEARLINE", "OPACTION", "REQUEST", "ANONYMOUSACCESS", "CISAUSES",
                          "ALL"
                      ]
                  },
                  "privilege_scope": {
                      "$ref": "#/definitions/privilege_scope"
                  },
                  "rule_effect": {
                      "type": "string",
                      "enum": [ "permit", "deny"]
                  }
              },
              "additionalProperties": false,
              "required": [
                "privilege_action",
                "privilege_scope",
                "rule_effect"
              ]
          },
          "further_sharing": {
              "type": "object",
              "properties": {
                  "sharing_scope": {
                      "type": "array",
                      "items": {
                          "type": "string",
                          "$comment": "enum is Appendix A of ACS 3.0 specification"
                      }
                  },
                  "rule_effect": {
                      "type": "string",
                      "enum": [ "permit", "deny"]
                  }
              },
              "additionalProperties": false
          }
       }
   }


